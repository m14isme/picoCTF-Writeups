# Client-side-again

Point: 200

## Category

Web Exploitation

## Question

Can you break into this super secure portal? https://jupiter.challenges.picoctf.org/problem/6353/ ([link](https://jupiter.challenges.picoctf.org/problem/6353/)) or http://jupiter.challenges.picoctf.org:6353

## Hint

What is [obfuscation](<https://en.wikipedia.org/wiki/Obfuscation_(software)>)?

## Solution

Check the source code, we have a obfuscation JS file.

```js
var _0x5a46 = [
  "0a029}",
  "_again_5",
  "this",
  "Password\x20Verified",
  "Incorrect\x20password",
  "getElementById",
  "value",
  "substring",
  "picoCTF{",
  "not_this",
];
(function (_0x4bd822, _0x2bd6f7) {
  var _0xb4bdb3 = function (_0x1d68f6) {
    while (--_0x1d68f6) {
      _0x4bd822["push"](_0x4bd822["shift"]());
    }
  };
  _0xb4bdb3(++_0x2bd6f7);
})(_0x5a46, 0x1b3);
var _0x4b5b = function (_0x2d8f05, _0x4b81bb) {
  _0x2d8f05 = _0x2d8f05 - 0x0;
  var _0x4d74cb = _0x5a46[_0x2d8f05];
  return _0x4d74cb;
};
function verify() {
  checkpass = document[_0x4b5b("0x0")]("pass")[_0x4b5b("0x1")];
  split = 0x4;
  if (checkpass[_0x4b5b("0x2")](0x0, split * 0x2) == _0x4b5b("0x3")) {
    if (checkpass[_0x4b5b("0x2")](0x7, 0x9) == "{n") {
      if (
        checkpass[_0x4b5b("0x2")](split * 0x2, split * 0x2 * 0x2) ==
        _0x4b5b("0x4")
      ) {
        if (checkpass[_0x4b5b("0x2")](0x3, 0x6) == "oCT") {
          if (
            checkpass[_0x4b5b("0x2")](split * 0x3 * 0x2, split * 0x4 * 0x2) ==
            _0x4b5b("0x5")
          ) {
            if (checkpass["substring"](0x6, 0xb) == "F{not") {
              if (
                checkpass[_0x4b5b("0x2")](
                  split * 0x2 * 0x2,
                  split * 0x3 * 0x2
                ) == _0x4b5b("0x6")
              ) {
                if (checkpass[_0x4b5b("0x2")](0xc, 0x10) == _0x4b5b("0x7")) {
                  alert(_0x4b5b("0x8"));
                }
              }
            }
          }
        }
      }
    }
  } else {
    alert(_0x4b5b("0x9"));
  }
}
```

Go to Chrome Developer Tools and then move to source tab. Then click to `index.html` and click to {} in the left of bottom to show pretty print. Then we have this code below.

```js
var _0x5a46 = [
  "0a029}",
  "_again_5",
  "this",
  "Password\x20Verified",
  "Incorrect\x20password",
  "getElementById",
  "value",
  "substring",
  "picoCTF{",
  "not_this",
];
(function (_0x4bd822, _0x2bd6f7) {
  var _0xb4bdb3 = function (_0x1d68f6) {
    while (--_0x1d68f6) {
      _0x4bd822["push"](_0x4bd822["shift"]());
    }
  };
  _0xb4bdb3(++_0x2bd6f7);
})(_0x5a46, 0x1b3);
var _0x4b5b = function (_0x2d8f05, _0x4b81bb) {
  _0x2d8f05 = _0x2d8f05 - 0x0;
  var _0x4d74cb = _0x5a46[_0x2d8f05];
  return _0x4d74cb;
};
function verify() {
  checkpass = document[_0x4b5b("0x0")]("pass")[_0x4b5b("0x1")];
  split = 0x4;
  if (checkpass[_0x4b5b("0x2")](0x0, split * 0x2) == _0x4b5b("0x3")) {
    if (checkpass[_0x4b5b("0x2")](0x7, 0x9) == "{n") {
      if (
        checkpass[_0x4b5b("0x2")](split * 0x2, split * 0x2 * 0x2) ==
        _0x4b5b("0x4")
      ) {
        if (checkpass[_0x4b5b("0x2")](0x3, 0x6) == "oCT") {
          if (
            checkpass[_0x4b5b("0x2")](split * 0x3 * 0x2, split * 0x4 * 0x2) ==
            _0x4b5b("0x5")
          ) {
            if (checkpass["substring"](0x6, 0xb) == "F{not") {
              if (
                checkpass[_0x4b5b("0x2")](
                  split * 0x2 * 0x2,
                  split * 0x3 * 0x2
                ) == _0x4b5b("0x6")
              ) {
                if (checkpass[_0x4b5b("0x2")](0xc, 0x10) == _0x4b5b("0x7")) {
                  alert(_0x4b5b("0x8"));
                }
              }
            }
          }
        }
      }
    }
  } else {
    alert(_0x4b5b("0x9"));
  }
}
```

So I've written some JS code to translate it. Then run this code in console. Basically, I'll print every single variable and its value to the console to see the value.

```js
console.log(0x0, split * 0x2, _0x4b5b("0x3"));
console.log(0x7, 0x9, "{n");
console.log(split * 0x2, split * 0x2 * 0x2, _0x4b5b("0x4"));
console.log(0x3, 0x6, "oCT");
console.log(split * 0x3 * 0x2, split * 0x4 * 0x2, _0x4b5b("0x5"));
console.log(0x6, 0xb, "F{not");
console.log(split * 0x2 * 0x2, split * 0x3 * 0x2, _0x4b5b("0x6"));
console.log(0xc, 0x10, _0x4b5b("0x7"));
```

Finally I've got the flag.

```bash
0 8 "picoCTF{"
7 9 "{n"
8 16 "not_this"
3 6 "oCT"
24 32 "0a029}"
6 11 "F{not"
16 24 "_again_5"
12 16 "this"
```

## Flag

`picoCTF{not_this_again_50a029}`
